<!DOCTYPE html>
<html lang="en">
<head>
    <title>Team Details</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .control { border: 1px solid #ccc; margin: 10px 0; padding: 10px; }
    </style>
</head>
<body>
    <h1>Team Details</h1>
    <div id="controls">Loading controls...</div>

    <script>
        // Extract the team parameter from the URL
        const urlParams = new URLSearchParams(window.location.search);
        const team = urlParams.get('team');

        // Display team name as a header
        document.body.insertAdjacentHTML('afterbegin', `<h2>Team: ${team}</h2>`);

        // Fetch controls from the backend
        fetch(`/api/getControls?team=${team}`)
            .then(response => response.json())
            .then(data => {
                const container = document.getElementById('controls');
                container.innerHTML = ''; // Clear loading message
                data.forEach(control => {
                    container.innerHTML += `
                        <div class="control">
                            <h3>${control.number}: ${control.description}</h3>
                            <p><strong>Owner:</strong> ${control.owner}</p>
                            <p><strong>Last Review:</strong> ${control.lastReview}</p>
                            <p><strong>Sign Off:</strong> ${control.signOff}</p>
                            ${control.evidence ? `<a href="${control.evidence}" target="_blank">View Evidence</a>` : ''}
                        </div>
                    `;
                });
            })
            .catch(err => {
                console.error('Error fetching data:', err);
                document.getElementById('controls').innerText = 'Error loading data.';
            });
    </script>
</body>
</html>
